# è‡ªå®šä¹‰åŠŸèƒ½å®ç°æ–¹æ¡ˆï¼ˆç®€åŒ–ç‰ˆï¼‰

> å·¥ä½œé‡è¯„ä¼°ï¼š**4-6å°æ—¶**å³å¯å®Œæˆæ ¸å¿ƒåŠŸèƒ½

---

## ğŸ¯ Phase 1: ä¸»é¢˜è‡ªå®šä¹‰ï¼ˆ2å°æ—¶ï¼‰â­ ä¼˜å…ˆå®ç°

### 1.1 æ‰©å±•é…ç½®ç±»å‹

```typescript
// src/types/config.ts - æ–°å¢ä¸»é¢˜é…ç½®
export interface ThemeConfig {
  // é¢œè‰²é…ç½®
  primaryColor: string
  accentColor: string
  backgroundColor: string

  // æ ·å¼é…ç½®
  borderRadius: 'small' | 'medium' | 'large'
  cardShadow: boolean
  fontSize: 'small' | 'medium' | 'large'

  // å¸ƒå±€é…ç½®
  gridColumns: number // ç½‘æ ¼åˆ—æ•°
  cardSpacing: number // å¡ç‰‡é—´è·
}

export interface AppConfig {
  // ... åŸæœ‰é…ç½®
  themeConfig: ThemeConfig // æ–°å¢
}
```

### 1.2 åˆ›å»ºä¸»é¢˜é…ç½®é¢æ¿ç»„ä»¶

**æ–‡ä»¶**: `src/components/settings/ThemeCustomizer.vue`

```vue
<template>
  <n-card title="ä¸»é¢˜è‡ªå®šä¹‰">
    <n-space vertical size="large">
      <!-- é¢œè‰²é…ç½® -->
      <n-form-item label="ä¸»é¢˜è‰²">
        <n-color-picker
          v-model:value="themeConfig.primaryColor"
          :swatches="colorPresets"
          @update:value="handleThemeUpdate"
        />
      </n-form-item>

      <!-- åœ†è§’é…ç½® -->
      <n-form-item label="åœ†è§’å¤§å°">
        <n-radio-group v-model:value="themeConfig.borderRadius">
          <n-radio value="small">å°</n-radio>
          <n-radio value="medium">ä¸­</n-radio>
          <n-radio value="large">å¤§</n-radio>
        </n-radio-group>
      </n-form-item>

      <!-- å­—ä½“å¤§å° -->
      <n-form-item label="å­—ä½“å¤§å°">
        <n-slider
          v-model:value="fontSizeValue"
          :min="12"
          :max="18"
          :step="2"
          :marks="{ 12: 'å°', 14: 'ä¸­', 16: 'å¤§', 18: 'è¶…å¤§' }"
        />
      </n-form-item>

      <!-- å¡ç‰‡é˜´å½± -->
      <n-form-item label="å¡ç‰‡é˜´å½±">
        <n-switch v-model:value="themeConfig.cardShadow" />
      </n-form-item>

      <!-- ç½‘æ ¼åˆ—æ•° -->
      <n-form-item label="æ¯è¡Œæ˜¾ç¤º">
        <n-slider
          v-model:value="themeConfig.gridColumns"
          :min="2"
          :max="6"
          :step="1"
          :marks="{ 2: '2', 3: '3', 4: '4', 5: '5', 6: '6' }"
        />
      </n-form-item>

      <!-- é¢„è®¾ä¸»é¢˜ -->
      <n-form-item label="é¢„è®¾ä¸»é¢˜">
        <n-space>
          <n-button @click="applyPreset('default')">é»˜è®¤</n-button>
          <n-button @click="applyPreset('ocean')">æµ·æ´‹</n-button>
          <n-button @click="applyPreset('forest')">æ£®æ—</n-button>
          <n-button @click="applyPreset('sunset')">æ—¥è½</n-button>
        </n-space>
      </n-form-item>

      <!-- é‡ç½®æŒ‰é’® -->
      <n-button block type="warning" @click="resetTheme">
        æ¢å¤é»˜è®¤ä¸»é¢˜
      </n-button>
    </n-space>
  </n-card>
</template>

<script setup lang="ts">
import { ref, computed } from 'vue'
import { useConfigStore } from '@/stores/config'

const configStore = useConfigStore()
const themeConfig = computed(() => configStore.config.themeConfig)

const colorPresets = [
  '#18a058', // é»˜è®¤ç»¿è‰²
  '#2080f0', // è“è‰²
  '#f0a020', // æ©™è‰²
  '#d03050', // çº¢è‰²
  '#722ed1', // ç´«è‰²
]

const themePresets = {
  default: {
    primaryColor: '#18a058',
    borderRadius: 'medium',
    fontSize: 'medium'
  },
  ocean: {
    primaryColor: '#2080f0',
    borderRadius: 'large',
    fontSize: 'medium'
  },
  forest: {
    primaryColor: '#18a058',
    borderRadius: 'small',
    fontSize: 'medium'
  },
  sunset: {
    primaryColor: '#f0a020',
    borderRadius: 'medium',
    fontSize: 'large'
  }
}

const fontSizeValue = computed({
  get: () => {
    const sizes = { small: 12, medium: 14, large: 16 }
    return sizes[themeConfig.value.fontSize]
  },
  set: (val) => {
    const sizes = { 12: 'small', 14: 'medium', 16: 'large', 18: 'large' }
    themeConfig.value.fontSize = sizes[val]
  }
})

function handleThemeUpdate() {
  configStore.updateConfig({ themeConfig: themeConfig.value })
  applyThemeToDOM()
}

function applyPreset(preset: string) {
  Object.assign(themeConfig.value, themePresets[preset])
  handleThemeUpdate()
}

function resetTheme() {
  // é‡ç½®ä¸ºé»˜è®¤å€¼
  Object.assign(themeConfig.value, themePresets.default)
  handleThemeUpdate()
}

function applyThemeToDOM() {
  const root = document.documentElement

  // åº”ç”¨CSSå˜é‡
  root.style.setProperty('--primary-color', themeConfig.value.primaryColor)

  // åº”ç”¨åœ†è§’
  const radiusMap = { small: '6px', medium: '12px', large: '16px' }
  root.style.setProperty('--border-radius', radiusMap[themeConfig.value.borderRadius])

  // åº”ç”¨å­—ä½“å¤§å°
  const fontMap = { small: '13px', medium: '14px', large: '16px' }
  root.style.setProperty('--font-size', fontMap[themeConfig.value.fontSize])
}
</script>
```

### 1.3 æ›´æ–°æ ·å¼æ–‡ä»¶

**æ–‡ä»¶**: `src/styles/main.css`

```css
/* æ–°å¢ä¸»é¢˜å˜é‡ */
:root {
  /* åŠ¨æ€å˜é‡ï¼ˆå¯è¢«è‡ªå®šä¹‰è¦†ç›–ï¼‰ */
  --primary-color: #18a058;
  --border-radius: 12px;
  --font-size: 14px;
  --card-spacing: 16px;

  /* æ´¾ç”Ÿå˜é‡ */
  --primary-hover: color-mix(in srgb, var(--primary-color) 90%, white);
  --primary-pressed: color-mix(in srgb, var(--primary-color) 110%, black);
}

/* åº”ç”¨åˆ°ç»„ä»¶ */
.bookmark-card {
  border-radius: var(--border-radius);
  font-size: var(--font-size);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.bookmark-grid {
  gap: var(--card-spacing);
  grid-template-columns: repeat(var(--grid-columns, 4), 1fr);
}
```

---

## ğŸ¯ Phase 2: æ‹–æ‹½æ’åºï¼ˆ2å°æ—¶ï¼‰

### 2.1 å®‰è£…ä¾èµ–

```bash
npm install vuedraggable@next --save
```

### 2.2 ä¿®æ”¹ BookmarkGrid ç»„ä»¶

**æ–‡ä»¶**: `src/components/bookmark/BookmarkGrid.vue` ï¼ˆæ–°å»ºï¼‰

```vue
<template>
  <draggable
    v-model="sortedBookmarks"
    class="bookmark-grid"
    item-key="id"
    :animation="200"
    :disabled="!sortable"
    @end="handleSortEnd"
  >
    <template #item="{ element }">
      <div class="bookmark-item">
        <bookmark-card
          :bookmark="element"
          @edit="emit('edit', element)"
          @delete="emit('delete', element)"
          @tag-click="emit('tagClick', $event)"
        />
      </div>
    </template>
  </draggable>
</template>

<script setup lang="ts">
import { computed } from 'vue'
import draggable from 'vuedraggable'
import BookmarkCard from './BookmarkCard.vue'
import { useBookmarkStore } from '@/stores/bookmark'
import type { Bookmark } from '@/types/bookmark'

interface Props {
  bookmarks: Bookmark[]
  sortable?: boolean
}

const props = withDefaults(defineProps<Props>(), {
  sortable: true
})

const emit = defineEmits<{
  edit: [bookmark: Bookmark]
  delete: [bookmark: Bookmark]
  tagClick: [tag: string]
}>()

const bookmarkStore = useBookmarkStore()

const sortedBookmarks = computed({
  get: () => props.bookmarks,
  set: (newValue) => {
    // æ›´æ–°æ’åº
    bookmarkStore.updateSortOrder(newValue)
  }
})

function handleSortEnd() {
  // ä¿å­˜æ–°é¡ºåºåˆ°å­˜å‚¨
  bookmarkStore.saveSortOrder()
}
</script>

<style scoped>
.bookmark-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: var(--card-spacing, 16px);
}

.bookmark-item {
  cursor: move;
  transition: transform 0.2s;
}

.bookmark-item:hover {
  transform: translateY(-2px);
}

/* æ‹–æ‹½æ—¶çš„æ ·å¼ */
.sortable-ghost {
  opacity: 0.4;
}

.sortable-drag {
  cursor: grabbing !important;
}
</style>
```

### 2.3 æ·»åŠ æ’åºå¼€å…³

åœ¨è®¾ç½®é¡µé¢æ·»åŠ æ‹–æ‹½æ’åºå¼€å…³ï¼š

```vue
<n-form-item label="å¯ç”¨æ‹–æ‹½æ’åº">
  <n-switch v-model:value="configStore.config.enableDragSort" />
</n-form-item>
```

---

## ğŸ¯ Phase 3: UI ä¼˜åŒ–ï¼ˆ2å°æ—¶ï¼‰

### 3.1 ä¼˜åŒ–ä¹¦ç­¾å¡ç‰‡æ ·å¼

**æ–‡ä»¶**: `src/components/bookmark/BookmarkCard.vue`

```vue
<style scoped>
.bookmark-card {
  /* ä½¿ç”¨ä¸»é¢˜å˜é‡ */
  border-radius: var(--border-radius);
  font-size: var(--font-size);

  /* æ¸å˜èƒŒæ™¯ï¼ˆå¯é€‰ï¼‰ */
  background: linear-gradient(
    135deg,
    var(--n-color) 0%,
    color-mix(in srgb, var(--n-color) 95%, var(--primary-color)) 100%
  );

  /* ä¼˜åŒ–é˜´å½± */
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);

  /* å¹³æ»‘è¿‡æ¸¡ */
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.bookmark-card:hover {
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
  transform: translateY(-4px);
  border-color: var(--primary-color);
}

/* å›¾æ ‡åœ†è§’ä¼˜åŒ– */
.card-favicon img {
  border-radius: calc(var(--border-radius) * 0.6);
}

/* æ ‡é¢˜æ¸å˜è‰²ï¼ˆå¯é€‰ï¼‰ */
.card-title {
  background: linear-gradient(90deg, var(--n-text-color), var(--primary-color));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}
</style>
```

### 3.2 æ·»åŠ åŠ è½½åŠ¨ç”»

```vue
<template>
  <div class="bookmark-grid">
    <transition-group name="bookmark-list">
      <bookmark-card
        v-for="bookmark in bookmarks"
        :key="bookmark.id"
        :bookmark="bookmark"
      />
    </transition-group>
  </div>
</template>

<style scoped>
.bookmark-list-move {
  transition: transform 0.3s ease;
}

.bookmark-list-enter-active {
  animation: bookmark-in 0.3s ease;
}

.bookmark-list-leave-active {
  animation: bookmark-out 0.3s ease;
  position: absolute;
}

@keyframes bookmark-in {
  from {
    opacity: 0;
    transform: scale(0.8) translateY(20px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

@keyframes bookmark-out {
  from {
    opacity: 1;
    transform: scale(1);
  }
  to {
    opacity: 0;
    transform: scale(0.8);
  }
}
</style>
```

---

## ğŸ“Š æ€»ç»“

### å·¥ä½œé‡åˆ†é…

| åŠŸèƒ½ | æ—¶é—´ | éš¾åº¦ | ä¼˜å…ˆçº§ |
|------|------|------|--------|
| ä¸»é¢˜è‡ªå®šä¹‰ | 2h | â­â­ | ğŸ”´ é«˜ |
| æ‹–æ‹½æ’åº | 2h | â­â­ | ğŸŸ¡ ä¸­ |
| UIä¼˜åŒ– | 2h | â­ | ğŸŸ¢ ä½ |
| **æ€»è®¡** | **6h** | - | - |

### å®æ–½å»ºè®®

1. **å…ˆåšä¸»é¢˜è‡ªå®šä¹‰** - è§†è§‰æ•ˆæœæœ€æ˜æ˜¾ï¼Œç”¨æˆ·ä½“éªŒæå‡æœ€å¤§
2. **å†åŠ æ‹–æ‹½æ’åº** - åŠŸèƒ½æ€§å¢å¼ºï¼Œæå‡æ˜“ç”¨æ€§
3. **æœ€åä¼˜åŒ–ç»†èŠ‚** - é”¦ä¸Šæ·»èŠ±

### æŠ€æœ¯è¦ç‚¹

- âœ… **é›¶å­¦ä¹ æˆæœ¬**: éƒ½æ˜¯ç°æˆçš„åº“å’ŒAPI
- âœ… **ä»£ç å¤ç”¨**: Naive UI ç»„ä»¶ç›´æ¥ç”¨
- âœ… **å¯ç»´æŠ¤æ€§**: é…ç½®é©±åŠ¨ï¼Œæ˜“äºæ‰©å±•
- âœ… **æ€§èƒ½ä¼˜åŒ–**: CSSå˜é‡ + GPUåŠ é€ŸåŠ¨ç”»

### é¢„æœŸæ•ˆæœ

å®Œæˆåç”¨æˆ·å¯ä»¥ï¼š
- ğŸ¨ è‡ªç”±è°ƒæ•´ä¸»é¢˜é¢œè‰²å’Œæ ·å¼
- ğŸ“ è‡ªå®šä¹‰å¸ƒå±€å¯†åº¦å’Œé—´è·
- ğŸ”„ æ‹–æ‹½è°ƒæ•´ä¹¦ç­¾é¡ºåº
- ğŸ’¾ ä¿å­˜å’Œæ¢å¤ä¸ªäººé…ç½®
- ğŸ“¤ å¯¼å‡ºå’Œåˆ†äº«ä¸»é¢˜é…ç½®

---

**å»ºè®®**: å…ˆèŠ±2å°æ—¶å®ç°Phase 1ï¼Œç«‹å³çœ‹åˆ°æ•ˆæœï¼Œå†å†³å®šæ˜¯å¦ç»§ç»­Phase 2å’Œ3ã€‚